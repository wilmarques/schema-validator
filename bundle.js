function e(e){var t={exports:{}};return e(t,t.exports),t.exports}var t=Object.prototype.toString,r=function(e){switch(t.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!=e?"nan":e&&1===e.nodeType?"element":null!=(r=e)&&(r._isBuffer||r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r))?"buffer":typeof(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e));var r};var n={set:function(e,t,r){for(var n=t.split("."),a=n.pop(),o=0;o<n.length;o++){var i=n[o];e[i]=e[i]||{},e=e[i]}e[a]=r},get:function(e,t){for(var r=t.split("."),n=r.pop(),a=0;a<r.length;a++){var o=r[a];if(!e[o])return;e=e[o]}return e[n]}},a=o;function o(e,t){var r=o[t];if("function"!=typeof r)throw new Error("cannot cast to "+t);return r(e)}o.string=function(e){return e.toString()},o.number=function(e){var t=parseFloat(e);return isNaN(t)?null:t},o.date=function(e){var t=new Date(e);return isNaN(t.valueOf())?null:t},o.array=function(e){if(e instanceof Array)return e;for(var t=e.toString().split(","),r=0;r<t.length;r++)t[r]=t[r].trim();return t},o.boolean=function(e){return!!e&&"false"!==e};var i,u=e((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"path",{enumerable:!1,configurable:!0,writable:!0,value:r}),Error.captureStackTrace&&Error.captureStackTrace(n,t),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}();t.default=r,e.exports=t.default})),s=e((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r,n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(r=u)&&r.__esModule?r:{default:r};function i(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.registry={},this._schema=r,this._type=null,this.messages={}}return a(e,[{key:"message",value:function(e){"string"==typeof e&&(e={default:e});var t=Object.entries(e),r=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=i.value,f=n(s,2),l=f[0],c=f[1];this.messages[l]=c}}catch(e){a=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw o}}return this}},{key:"schema",value:function(e){return this._schema.path(this.name,e),this}},{key:"use",value:function(e){var t=this;return Object.keys(e).forEach((function(r){var n=e[r];Array.isArray(n)||(n=[n]);var a=n.shift();t._register(r,n,a)})),this}},{key:"required",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._register("required",[e])}},{key:"type",value:function(e){return this._type=e,this._register("type",[e])}},{key:"length",value:function(e){return this._register("length",[e])}},{key:"enum",value:function(e){return this._register("enum",[e])}},{key:"match",value:function(e){return this._register("match",[e])}},{key:"each",value:function(e){return this._schema.path(this.name+".$",e),this}},{key:"elements",value:function(e){var t=this;return e.forEach((function(e,r){t._schema.path(t.name+"."+r,e)})),this}},{key:"path",value:function(){var e;return(e=this._schema).path.apply(e,arguments)}},{key:"typecast",value:function(e){var t=this._schema,r=this._type;if(!r)return e;"function"==typeof r&&(r=r.name);var n=t.typecasters[r]||t.typecasters[r.toLowerCase()];if("function"!=typeof n)throw new Error("Typecasting failed: No typecaster defined for "+r+".");return n(e)}},{key:"validate",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.name,n=Object.keys(this.registry),a={},o=void 0;if(o=this._run("required",e,t,r))return o;if(null==e)return null;if(o=this._run("type",e,t,r))return o;a.required=!0,a.type=!0;var i=!0,u=!1,s=void 0;try{for(var f,l=n[Symbol.iterator]();!(i=(f=l.next()).done);i=!0){var c=f.value;if(!a[c]&&(o=this._run(c,e,t,r)))return o}}catch(o){u=!0,s=o}finally{try{!i&&l.return&&l.return()}finally{if(u)throw s}}return null}},{key:"_run",value:function(e,t,r,n){if(this.registry[e]){var a=this._schema,o=this.registry[e],u=o.args;return(o.fn||a.validators[e]).apply(void 0,[t,r].concat(i(u),[n]))?void 0:this._error(e,r,u,n)}}},{key:"_register",value:function(e,t,r){return this.registry[e]={args:t,fn:r},this}},{key:"_error",value:function(e,t,r,n){var a=this._schema,u=this.messages[e]||this.messages.default||a.messages[e]||a.messages.default;return"function"==typeof u&&(u=u.apply(void 0,[n,t].concat(i(r)))),new o.default(u,n)}}]),e}();t.default=s,e.exports=t.default})),f=e((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.default={type:function(e,t,r){return"function"==typeof r&&(r=r.name),e+" must be of type "+r+"."},required:function(e){return e+" is required."},match:function(e,t,r){return e+" must match "+r+"."},length:function(e,t,r){if("number"==typeof r)return e+" must have a length of "+r+".";var n=r.min,a=r.max;return n&&a?e+" must have a length between "+n+" and "+a+".":a?e+" must have a maximum length of "+a+".":n?e+" must have a minimum length of "+n+".":void 0},enum:function(e,t,r){var n=r.slice(),a=n.pop();return e+" must be either "+n.join(", ")+" or "+a+"."},default:function(e){return"Validation failed for "+e+"."}},e.exports=t.default})),l=e((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=r)&&n.__esModule?n:{default:n};var o={required:function(e,t,r){return!1===r||null!=e&&""!==e},type:function(e,t,r){return"function"==typeof r?e.constructor===r:(0,a.default)(e)===r},length:function(e,t,r){if("number"==typeof r)return e.length===r;var n=r.min,a=r.max;return!(n&&e.length<n)&&!(a&&e.length>a)},enum:function(e,t,r){return r.includes(e)},match:function(e,t,r){return r.test(e)}};t.default=o,e.exports=t.default})),c=function(e,t,r){if("string"==typeof e)return void(r[e]=t);Object.keys(e).forEach((function(t){return r[t]=e[t]}))},h=function e(t,r,n){var a=t.split(/\.\$(?=\.|$)/),o=a.shift(),i=p.default.get(r,o);if(!a.length)return n(o,i);if(!Array.isArray(i))return;for(var u=0;u<i.length;u++){var s=v(u,o)+a.join(".$");e(s,r,n)}},y=v,p=(i=n)&&i.__esModule?i:{default:i};function v(e,t){return t?t+"."+e:e}var d=Object.defineProperty({assign:c,walk:h,join:y},"__esModule",{value:!0}),g=e((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=b(r),h=b(n),y=b(a),p=b(s),v=b(f),g=b(l),m=b(u);function b(e){return e&&e.__esModule?e:{default:e}}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};j(this,e),this.opts=n,this.hooks=[],this.props={},this.messages=Object.assign({},v.default),this.validators=Object.assign({},g.default),this.typecasters=Object.assign({},y.default),Object.keys(r).forEach((function(e){return t.path(e,r[e])}))}return i(e,[{key:"path",value:function(t,r){var n=this,a=t.split("."),o=a.pop(),i=a.join(".");if(i&&this.path(i),"$"===o&&this.path(i).type(Array),r instanceof e)return r.hook((function(e,r){return n.path((0,d.join)(e,t),r)})),this.path(t,r.props);if(r instanceof p.default)return this.props[t]=r,this.propagate(t,r),r;var u=this.props[t]||new p.default(t,this);if(this.props[t]=u,this.propagate(t,u),!r)return u;if("string"==typeof r||"function"==typeof r)return u.type(r),u;if(Array.isArray(r))return u.type(Array),1==r.length?u.each(r[0]):u.elements(r),u;var s=!1;for(var f in r)if(r.hasOwnProperty(f)&&"function"!=typeof u[f]){s=!0;break}return Object.keys(r).forEach((function(e){var a=r[e];if(s)return n.path((0,d.join)(e,t),a);u[e](a)})),u}},{key:"typecast",value:function(e){var t=function(t,r){(0,d.walk)(t,e,(function(t,n){if(null!=n){var a=r.typecast(n);a!==n&&h.default.set(e,t,a)}}))},r=!0,n=!1,a=void 0;try{for(var i,u=Object.entries(this.props)[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=i.value,f=o(s,2);t(f[0],f[1])}}catch(e){n=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw a}}return this}},{key:"strip",value:function(e,t){var r=this,n=(0,c.default)(e);if("array"===n)return e.forEach((function(e,n){return r.strip(e,(0,d.join)("$",t))})),this;if("object"!==n)return this;var a=!0,i=!1,u=void 0;try{for(var s,f=Object.entries(e)[Symbol.iterator]();!(a=(s=f.next()).done);a=!0){var l=s.value,h=o(l,2),y=h[0],p=h[1],v=(0,d.join)(y,t);this.props[v]?this.strip(p,v):delete e[y]}}catch(e){i=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(i)throw u}}return this}},{key:"validate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Object.assign(this.opts,t);var r=[];t.typecast&&this.typecast(e),!1!==t.strip&&this.strip(e);var n=function(t,n){(0,d.walk)(t,e,(function(t,a){var o=n.validate(a,e,t);o&&r.push(o)}))},a=!0,i=!1,u=void 0;try{for(var s,f=Object.entries(this.props)[Symbol.iterator]();!(a=(s=f.next()).done);a=!0){var l=s.value,c=o(l,2),h=c[0],y=c[1];n(h,y)}}catch(e){i=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(i)throw u}}return r}},{key:"assert",value:function(e,t){var r=this.validate(e,t),n=o(r,1)[0];if(n)throw n}},{key:"message",value:function(e,t){return(0,d.assign)(e,t,this.messages),this}},{key:"validator",value:function(e,t){return(0,d.assign)(e,t,this.validators),this}},{key:"typecaster",value:function(e,t){return(0,d.assign)(e,t,this.typecasters),this}},{key:"hook",value:function(e){return this.hooks.push(e),this}},{key:"propagate",value:function(e,t){return this.hooks.forEach((function(r){return r(e,t)})),this}}]),e}();t.default=_,_.ValidationError=m.default,e.exports=t.default}));const m=(e,t,r)=>console.log(e,t);var b={info:e=>m("INFO",e),warn:e=>m("WARNING",e),error:e=>m("ERROR",e),success:e=>m("SUCCESS",e),green:e=>console.log(e),blue:e=>console.log(e),red:e=>console.log(e),yellow:e=>console.log(e),blueBold:e=>console.log(e)};const j={getSchema:e=>_(e)},_=e=>{let t=e instanceof Array?[]:{};for(let r in e){const n="object"==typeof e[r];t[r]=n?_(e[r]):w[e[r]]||e[r]}return t},w={string:String,number:Number,boolean:Boolean};var O=(e,t,r=3)=>(e.length||t.length?(r>2&&(b.error("====== Schema Validation Error ======"),b.error(`${e.length} mismatches and ${t.length} warnings found.`)),r&&e.forEach(((e,t)=>b.red(`${t+1}. ${e.message}`))),r>1&&t.forEach(((e,t)=>b.yellow(`${t+1}. ${e.message}`)))):r>2&&b.success("Schema Validated Successfully"),e.concat(t)),k={logger:b,schemaBuilder:j,utils:{},printErrors:O};const{logger:E,schemaBuilder:S,printErrors:A}=k,x={none:0,error:1,warn:2,verbose:3},$=(e,t)=>{let r=[];const n=e=>e&&([String,Number,Boolean].includes(e.type)||"boolean"==typeof e.required),a=(e,t,o="")=>{if("object"==typeof e)for(let i in e){let u=e instanceof Array?t[0]:t[i];const s=o?`${o}.${i}`:i;!u||"object"!=typeof e[i]&&!n(u)?r.push({path:s,message:`${s} is not present in schema`}):a(e[i],u,s)}};return a(e,t),r},P=e=>{let t={};for(let r in e)if("object"==typeof e[r])if(Array.isArray(e[r])){let n=e[r][0];t[r]=["object"==typeof n?P(n):{type:typeof n}]}else t[r]=P(e[r]);else t[r]={required:!0,type:typeof e[r]};return t};var N=(e,t={})=>{if(!e)return E.error("Missing argument: either targetObject or filePath is required");if("string"==typeof e)return E.error("This version does not support filePathes, only objects");x[t.logLevel]>2&&E.info(`Validating schema for: ${JSON.stringify(e)}`);try{t.schemaObj&&(t.schema=P(t.schemaObj));let r=t.schema||t.schemaPath||`${__dirname}/../examples/schema.json`;const n=S.getSchema(r),a=e,o=JSON.parse(JSON.stringify(a)),i=new g(n).validate(a).map((e=>({path:e.path,message:e.message}))),u=$(o,n);return A(i,u,x[t.logLevel])}catch(e){E.error(e)}};export default N;
